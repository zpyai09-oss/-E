<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <title>Ù…Ù†ØµØ© E - Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© | E Platform - Home</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Arial,Helvetica,sans-serif; direction:rtl;
      background:url('background.jpg') center/cover no-repeat;
      color:#fff;
    }
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:rgba(0,0,0,0.55)}
    .logo{display:flex;align-items:center;gap:10px}
    .logo img{width:56px;height:auto;border-radius:6px}
    .nav{display:flex;gap:10px;flex-wrap:wrap}
    .nav a{color:orange;text-decoration:none;padding:8px 12px;background:rgba(255,165,0,0.08);border-radius:6px}
    .hero{max-width:1000px;margin:28px auto;padding:20px;background:rgba(0,0,0,0.52);border-radius:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-top:16px}
    .card{background:rgba(255,255,255,0.04);padding:16px;border-radius:10px;text-align:right}
    .card h2{color:lightgreen;margin:0 0 8px}
    .card p{color:#eee;line-height:1.6}
    .btn{display:inline-block;padding:10px 14px;background:orange;color:#fff;border-radius:8px;text-decoration:none;margin-top:10px}
    footer{text-align:center;padding:14px;color:#ddd;background:rgba(0,0,0,0.45);position:fixed;left:0;right:0;bottom:0}
    .user-card{display:flex;align-items:center;gap:12px}
    .user-photo{width:56px;height:56px;border-radius:50%;object-fit:cover;border:2px solid rgba(255,255,255,0.08)}
    .user-info{display:flex;flex-direction:column}
    .user-name{font-weight:bold;color:lightgreen}
    .user-email{font-size:13px;color:#ddd}
    .profile-btn{padding:8px 10px;border-radius:8px;background:rgba(255,165,0,0.12);color:orange;border:1px solid rgba(255,165,0,0.06);cursor:pointer}
    @media(max-width:520px){.topbar{padding:10px}.hero{margin:16px}}
  </style>
</head>
<body>

  <div class="topbar">
    <div class="logo">
      <img src="logo.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØµØ©">
      <div>
        <div style="font-weight:bold">Ù…Ù†ØµØ© E</div>
        <div style="font-size:12px;color:#ddd">E Platform</div>
      </div>
    </div>

    <nav class="nav">
      <a href="home.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© | Home</a>
      <a href="grammar.html">ğŸ“˜ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ | Grammar</a>
      <a href="basics.html">ğŸ§  Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª | Basics</a>
      <a href="community.html">ğŸ‘¥ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ | Community</a>
      <a href="chat.html">ğŸ’¬ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª | Chat</a>
      <a href="login.html">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ | Login</a>
    </nav>
  </div>

  <main class="hero">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap">
      <div class="user-card">
        <img id="userPhoto" class="user-photo" src="default-user.png" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
        <div class="user-info">
          <div id="userName" class="user-name">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
          <div id="userEmail" class="user-email"></div>
        </div>
        <button id="openProfile" class="profile-btn">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
      </div>

      <div style="max-width:560px">
        <h1 style="margin:0;color:orange">ğŸŒŸ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© E â€” Welcome to E Platform</h1>
        <p style="margin-top:10px;color:#f0f0f0">
          Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ù†Ø¸Ù…Ø© Ù„ØªØ±Ø´Ø¯Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ØŒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§ØªØŒ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ØŒ ÙˆØ§Ù„Ù†Ø´Ø± ÙˆØ§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª.
        </p>
      </div>
    </div>

    <div class="grid" style="margin-top:18px">
      <div class="card">
        <h2>ğŸ“˜ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ | Grammar</h2>
        <p>Ø´Ø±Ø­ Ù…ÙØµÙ„ Ù„Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©: Ø§Ù„Ø£Ø²Ù…Ù†Ø©ØŒ Ø§Ù„Ù…Ø¨Ù†ÙŠ Ù„Ù„Ù…Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„Ù…Ø¬Ù‡ÙˆÙ„ØŒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŒ Ø§Ù„ØµÙØ§ØªØŒ Ø§Ù„Ø¸Ø±ÙˆÙ...</p>
        <a class="btn" href="grammar.html">Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</a>
      </div>

      <div class="card">
        <h2>ğŸ§  Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª | Basics</h2>
        <p>Ù‚ÙˆØ§Ø¦Ù… ÙƒÙ„Ù…Ø§Øª Ù…Ø¹ Ø¬Ù…Ù„ ÙƒØ§Ù…Ù„Ø© ÙˆØªØ±Ø¬Ù…ØªÙ‡Ø§ØŒ ÙˆÙ†Ø·Ù‚ Ù…Ø¨Ø³Ø· ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø©.</p>
        <a class="btn" href="basics.html">Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª</a>
      </div>

      <div class="card">
        <h2>ğŸ‘¥ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ | Community</h2>
        <p>Ø£Ù†Ø´Ø± Ù…Ù†Ø´ÙˆØ±Ø§Ù‹ØŒ Ø§Ù‚Ø±Ø£ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†ØŒ Ø§Ø¨Ø­Ø«ØŒ Ø¹Ù„Ù‘Ù‚ ÙˆØ£Ø¹Ø¬Ø¨ Ø¨Ù…Ø§ ÙŠØ¹Ø¬Ø¨Ùƒ.</p>
        <a class="btn" href="community.html">Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</a>
      </div>

      <div class="card">
        <h2>ğŸ’¬ Ù…Ø­Ø§Ø¯Ø«Ø§Øª | Chat</h2>
        <p>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¢Ø®Ø±ÙŠÙ†ØŒ ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ù…Ø¹Ø±ÙØ© ÙˆØ§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ©.</p>
        <a class="btn" href="chat.html">Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</a>
      </div>
    </div>
  </main>

  <footer>Â© Ù…Ù†ØµØ© E â€” E Platform</footer>

  <!-- ÙƒÙˆØ¯ Firebase (module) - Ø§Ù†Ø³Ø® Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªÙŠ Ø£Ø¹Ø·Ø§Ùƒ Ø¥ÙŠØ§Ù‡Ø§ Ù…ÙˆÙ‚Ø¹ Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    import { getStorage, ref as sRef, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-storage.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDlH5QLPBbqMqr4WOhQY7XtSH-3KIzV8-o",
      authDomain: "e-platform-20de2.firebaseapp.com",
      projectId: "e-platform-20de2",
      storageBucket: "e-platform-20de2.firebasestorage.app",
      messagingSenderId: "852282304347",
      appId: "1:852282304347:web:8a90926fbf8eeef1551c7e",
      measurementId: "G-MGH8K3W6HG"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // DOM
    const userPhotoEl = document.getElementById('userPhoto');
    const userNameEl = document.getElementById('userName');
    const userEmailEl = document.getElementById('userEmail');
    const openProfileBtn = document.getElementById('openProfile');

    // ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ØµÙˆØ±Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
    const DEFAULT_PHOTO = 'default-user.png'; // Ø¶Ø¹ Ù…Ù„Ù ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

    // Ø¹Ù†Ø¯ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ Ù†Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firestore (collection: users, doc: uid)
    onAuthStateChanged(auth, async user => {
      if (!user) {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ ÙŠÙ…ÙƒÙ† Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø§Ø¨Ø· Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        userNameEl.textContent = 'Ø²Ø§Ø¦Ø±';
        userEmailEl.textContent = '';
        userPhotoEl.src = DEFAULT_PHOTO;
        openProfileBtn.textContent = 'Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
        openProfileBtn.onclick = () => window.location.href = 'login.html';
        return;
      }

      userEmailEl.textContent = user.email || user.phoneNumber || '';
      // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù„Ù Ù…Ù† Firestore
      try {
        const uDoc = doc(db, 'users', user.uid);
        const snap = await getDoc(uDoc);
        if (snap.exists()) {
          const data = snap.data();
          userNameEl.textContent = data.displayName || user.email || 'Ù…Ø³ØªØ®Ø¯Ù…';
          if (data.photoPath) {
            // Ø¥Ø°Ø§ Ø®ÙØ²Ù† Ø§Ù„Ù…Ø³Ø§Ø± ÙÙŠ Storage Ù†Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Storage
            try {
              const url = await getDownloadURL(sRef(storage, data.photoPath));
              userPhotoEl.src = url;
            } catch {
              userPhotoEl.src = data.photoURL || user.photoURL || DEFAULT_PHOTO;
            }
          } else {
            userPhotoEl.src = data.photoURL || user.photoURL || DEFAULT_PHOTO;
          }
        } else {
          // Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ users: Ù†Ù†Ø´Ø¦ Ù…Ø³ØªÙ†Ø¯ Ø£Ø³Ø§Ø³ÙŠ
          await setDoc(uDoc, {
            displayName: user.displayName || '',
            photoURL: user.photoURL || '',
            bio: ''
          });
          userNameEl.textContent = user.displayName || user.email || 'Ù…Ø³ØªØ®Ø¯Ù…';
          userPhotoEl.src = user.photoURL || DEFAULT_PHOTO;
        }
      } catch (e) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', e);
        userNameEl.textContent = user.email || 'Ù…Ø³ØªØ®Ø¯Ù…';
        userPhotoEl.src = user.photoURL || DEFAULT_PHOTO;
      }

      openProfileBtn.textContent = 'Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ';
      openProfileBtn.onclick = () => {
        // Ù†Ù…Ø±Ø± uid ÙÙŠ Ø±Ø§Ø¨Ø· Ø£Ùˆ Ù†ÙØªØ­ profile.html Ø§Ù„Ø°ÙŠ Ø³ÙŠÙ‚Ø±Ø£ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† Firebase
        window.location.href = 'profile.html';
      };
    });
  </script>
<link rel="stylesheet" href="style.css">
</body>
</html>