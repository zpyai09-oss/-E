
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ | Login - Ù…Ù†ØµØ© E</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      direction: rtl;
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
      text-align: center;
    }
    header {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      padding: 10px 20px;
    }
    header img {
      width: 60px;
      height: auto;
      border-radius: 8px;
    }
    h1 { font-size: 24px; margin-top: 10px; color: orange; }
    .container {
      margin: 30px auto;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 350px;
    }
    input { padding: 10px; margin: 10px 0; width: 100%; border-radius: 5px; border: none; }
    button {
      padding: 10px; background-color: orange; border: none; border-radius: 5px;
      color: white; font-weight: bold; width: 100%; cursor: pointer;
    }
    .links { margin-top: 10px; font-size: 14px; cursor: pointer; color: orange; }
    .hidden { display: none; }
    .message { margin-top: 15px; font-size: 14px; color: lightgreen; word-break:break-word; }
    .error { color: #ff8a80; }
  </style>
</head>
<body>

  <header>
    <img src="logo.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØµØ©">
  </header>

  <h1>ğŸŒŸ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© E</h1>

  <div class="container">
    <!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-form">
      <input id="login-identifier" type="text" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
      <input id="login-password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <button id="login-btn">Ø¯Ø®ÙˆÙ„</button>
      <div class="links" id="forgot-link">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</div>
      <div class="links" id="register-link">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
      <div id="login-message" class="message"></div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ -->
    <div id="register-form" class="hidden">
      <input id="reg-email" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
      <input id="pass1" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <input id="pass2" type="password" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <button id="register-btn">ØªØ³Ø¬ÙŠÙ„</button>
      <div id="register-message" class="message"></div>
      <div class="links" id="back-to-login-1">Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ù†Ø³ÙŠØ§Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
    <div id="forgot-form" class="hidden">
      <input id="forgot-email" type="email" placeholder="Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
      <button id="forgot-btn">Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</button>
      <div id="forgot-message" class="message"></div>
      <div class="links" id="back-to-login-2">Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
    </div>

    <!-- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="menu" class="hidden">
      <h2 style="color: lightgreen;">ğŸ“š Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
      <button onclick="window.location.href='index.html'">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© | Home</button><br><br>
      <button onclick="window.location.href='grammar.html'">ğŸ“˜ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ | Grammar</button><br><br>
      <button onclick="window.location.href='basics.html'">ğŸ§  Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª | Basics</button><br><br>
      <button onclick="window.location.href='community.html'">ğŸ‘¥ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ | Community</button>
      <div style="margin-top:12px">
        <button id="signout-btn" style="background:#ff6b6b">Ø®Ø±ÙˆØ¬</button>
      </div>
    </div>
  </div>

  <!-- Ù‡Ù†Ø§ Ù†Ø¶Ø¹ ÙƒÙˆØ¯ Firebase Ø¨Ù†Ù…Ø· module ÙƒÙ…Ø§ Ø£Ø¹Ø·Ø§Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
  <script type="module">
    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø§ Ù†Ø­ØªØ§Ø¬Ù‡ Ù…Ù† Ù…ÙƒØªØ¨Ø§Øª Firebase (Ù†Ø³Ø®Ø© Ø±Ø³Ù…ÙŠØ© Ø­Ø¯ÙŠØ«Ø©)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    import { getStorage } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-storage.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";

    // ØªÙƒÙˆÙŠÙ† Ù…Ø´Ø±ÙˆØ¹ Firebase (Ø§Ù†Ø³Ø®ØªÙ‡ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ)
    const firebaseConfig = {
      apiKey: "AIzaSyDlH5QLPBbqMqr4WOhQY7XtSH-3KIzV8-o",
      authDomain: "e-platform-20de2.firebaseapp.com",
      projectId: "e-platform-20de2",
      storageBucket: "e-platform-20de2.firebasestorage.app",
      messagingSenderId: "852282304347",
      appId: "1:852282304347:web:8a90926fbf8eeef1551c7e",
      measurementId: "G-MGH8K3W6HG"
    };

    // ØªÙ‡ÙŠØ¦Ø© Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Ø¹Ù†Ø§ØµØ± DOM
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const forgotForm = document.getElementById('forgot-form');
    const menu = document.getElementById('menu');

    const loginBtn = document.getElementById('login-btn');
    const registerBtn = document.getElementById('register-btn');
    const forgotBtn = document.getElementById('forgot-btn');
    const signoutBtn = document.getElementById('signout-btn');

    const loginMsg = document.getElementById('login-message');
    const regMsg = document.getElementById('register-message');
    const forgotMsg = document.getElementById('forgot-message');

    // ØªÙˆØ¬ÙŠÙ‡ ÙˆØ§Ø¬Ù‡Ø©
    document.getElementById('register-link').addEventListener('click', () => show('register'));
    document.getElementById('forgot-link').addEventListener('click', () => show('forgot'));
    document.getElementById('back-to-login-1').addEventListener('click', () => show('login'));
    document.getElementById('back-to-login-2').addEventListener('click', () => show('login'));

    function show(name) {
      loginForm.classList.add('hidden');
      registerForm.classList.add('hidden');
      forgotForm.classList.add('hidden');
      menu.classList.add('hidden');
      if (name === 'login') loginForm.classList.remove('hidden');
      if (name === 'register') registerForm.classList.remove('hidden');
      if (name === 'forgot') forgotForm.classList.remove('hidden');
      if (name === 'menu') menu.classList.remove('hidden');
      clearMessages();
    }

    function clearMessages() {
      loginMsg.textContent = '';
      regMsg.textContent = '';
      forgotMsg.textContent = '';
    }

    // ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ (email/password)
    registerBtn.addEventListener('click', async () => {
      const email = document.getElementById('reg-email').value.trim();
      const p1 = document.getElementById('pass1').value;
      const p2 = document.getElementById('pass2').value;
      if (!email || !p1 || p1 !== p2 || p1.length < 6) {
        regMsg.textContent = 'âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ£Ù†Ù‡Ø§ Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 6 Ø£Ø­Ø±Ù.';
        regMsg.classList.add('error');
        return;
      }
      try {
        const userCred = await createUserWithEmailAndPassword(auth, email, p1);
        regMsg.textContent = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­.';
        regMsg.classList.remove('error');
        // Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù†Ù†ØªÙ‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø±Ø³Ø§Ù„ ØªØ­Ù‚Ù‚ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯
        setTimeout(() => { window.location.href = 'chat.html'; }, 800);
      } catch (e) {
        regMsg.textContent = 'âŒ ' + e.message;
        regMsg.classList.add('error');
      }
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ (email/password)
    loginBtn.addEventListener('click', async () => {
      const id = document.getElementById('login-identifier').value.trim();
      const pass = document.getElementById('login-password').value;
      if (!id || !pass) { loginMsg.textContent = 'âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯/Ø§Ù„Ø±Ù‚Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.'; loginMsg.classList.add('error'); return; }

      // Ù‡Ù†Ø§ Ù†ÙØªØ±Ø¶ Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯. Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø¯Ø¹Ù… Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙØŒ Ù†Ø­ØªØ§Ø¬ ØªÙ†ÙÙŠØ° Phone Auth Ù…Ù†ÙØµÙ„.
      try {
        await signInWithEmailAndPassword(auth, id, pass);
        loginMsg.textContent = 'âœ… ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„';
        loginMsg.classList.remove('error');
        setTimeout(() => { window.location.href = 'chat.html'; }, 700);
      } catch (e) {
        loginMsg.textContent = 'âŒ ' + e.message;
        loginMsg.classList.add('error');
      }
    });

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø·/Ø±Ù…Ø² Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯
    forgotBtn.addEventListener('click', async () => {
      const email = document.getElementById('forgot-email').value.trim();
      if (!email) { forgotMsg.textContent = 'âš ï¸ Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.'; forgotMsg.classList.add('error'); return; }
      try {
        await sendPasswordResetEmail(auth, email);
        forgotMsg.textContent = 'ğŸ“© ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.';
        forgotMsg.classList.remove('error');
      } catch (e) {
        forgotMsg.textContent = 'âŒ ' + e.message;
        forgotMsg.classList.add('error');
      }
    });

    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
    onAuthStateChanged(auth, user => {
      if (user) {
        // Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ - Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
        // ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¨Ù‚Ø§Ø¦Ù‡ ÙÙŠ Ø§Ù„ØµÙØ­Ø© ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:
        // show('menu');
        // Ø£Ùˆ Ø§Ù„ØªÙˆØ¬Ù‘Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ chat.html:
        // window.location.href = 'chat.html';
        console.log('Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªØµÙ„:', user.email);
      } else {
        console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªØµÙ„');
      }
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    signoutBtn && signoutBtn.addEventListener('click', async () => {
      await signOut(auth);
      show('login');
    });

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù†Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
    show('login');
  </script>
<link rel="stylesheet" href="style.css">
</body>
</html>